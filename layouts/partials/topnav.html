{{ $productPathData := findRE "[^/]+.*?" .RelPermalink }}
{{ $product := index $productPathData 0 }}
{{ $currentVersion := index $productPathData 1 }}

<div class="topnav">
  <div class="topnav--left">
    <a class="influx-home" href="https://www.influxdata.com" title="InfluxData"><span class="icon-influx-logo"></span><span class="icon-influx-logotype"></span></a>
    <span class="divider"></span>
    <a class="docs-home" href="/{{ $.Site.Data.versions.stable_version }}">InfluxDB Docs</a>
  </div>
  <div class="topnav--right">
    {{ if or (eq $product nil) (eq $currentVersion nil) }}
    {{ else }}
    <div class="version-selector">
      <p class="selected">{{ $currentVersion }}</p>
      <ul class="version-list">
        {{ range (index .Site.Menus $product).ByName.Reverse }}
          <li>
            <a href="{{ .URL }}">{{ .Name }}</a>
          </li>
        {{ end }}
        <li><a href="https://github.com/influxdata/docs.influxdata.com" class="legacy" target="_blank">v0.x</a></li>
      </ul>
    </div>
    {{ end }}
    <button id="search-btn" onclick="toggle_sidebar('sidebar-open');document.getElementById('algolia-search-input').focus();return false;"><span class="icon-search"></span></button>
    <button class="url-trigger" href="#"><span class="icon-ui-cog-thick"></span></button>
    <button class="theme-switcher" id="theme-switch-light" onclick="switch_style('light-theme');return false;"><span class="icon-sun1"></span></button>
    <button class="theme-switcher" id="theme-switch-dark" onclick="switch_style('dark-theme');return false;"><span class="icon-moon1"></span></button>
  </div>
</div>
